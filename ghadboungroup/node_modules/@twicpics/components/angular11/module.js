import{EventEmitter,Component,ChangeDetectionStrategy,ViewEncapsulation,Input,Output,Renderer2,ElementRef,HostBinding,ViewChild,NgModule}from"@angular/core";import{CommonModule}from"@angular/common";class TwicBackgroundComponent{constructor(){this.anchor=void 0,this.bot=void 0,this.focus=void 0,this.intrinsic=void 0,this.mediaTag="div",this.mode=void 0,this.placeholder=void 0,this.position=void 0,this.preTransform=void 0,this.ratio=void 0,this.step=void 0,this.transitionDelay=void 0,this.transitionDuration=void 0,this.transitionTimingFunction=void 0,this.stateChangeEvent=new EventEmitter}onStateChange(stateEvent){this.stateChangeEvent.emit(stateEvent)}}TwicBackgroundComponent.decorators=[{type:Component,args:[{selector:"TwicBackground",template:`
        <TwicMedia
            [anchor]="anchor"
            [bot]="bot"
            [focus]="focus"
            [intrinsic]="intrinsic"
            [mode]="mode"
            [mediaTag]="mediaTag"
            [eager]="eager"
            [placeholder]="placeholder"
            [position]="position"
            [preTransform]="preTransform"
            [ratio]="ratio"
            [src]="src"
            [step]="step"
            [transition]="transition"
            [transitionDelay]="transitionDelay"
            [transitionDuration]="transitionDuration"
            [transitionTimingFunction]="transitionTimingFunction"
            (stateChangeEvent)="onStateChange($event)"
        ></TwicMedia>
    `,changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,host:{class:"twic-i twic-d"}}]}],TwicBackgroundComponent.propDecorators={anchor:[{type:Input}],bot:[{type:Input}],focus:[{type:Input}],intrinsic:[{type:Input}],mediaTag:[{type:Input}],mode:[{type:Input}],eager:[{type:Input}],placeholder:[{type:Input}],position:[{type:Input}],preTransform:[{type:Input}],ratio:[{type:Input}],src:[{type:Input}],step:[{type:Input}],transition:[{type:Input}],transitionDelay:[{type:Input}],transitionDuration:[{type:Input}],transitionTimingFunction:[{type:Input}],stateChangeEvent:[{type:Output}]};const createElement=data=>{if(data){var{attributes:data,element:_element,elementName,value}=data,element=_element||document.createElement(elementName||"div");if(data&&element instanceof HTMLElement)for(var[n,v]of Object.entries(data))element.setAttribute(n,String(v));if(value)if("string"==typeof value)element.innerHTML=value;else for(const child of Array.isArray(value)?value:[value]){var actualChild=createElement(child);actualChild&&element.appendChild(actualChild)}return element}},rPx=/px$/,cssWithoutPx=css=>Number(css.replace(rPx,"")),buildErrorMessage=message=>"twicpics-components "+message,ɵ0$6=buildErrorMessage,mappingBoolean$1={true:!0,false:!1,"":!0},convertToBoolean=value=>"boolean"==typeof value?value:void 0!==value&&(mappingBoolean$1[value.trim()]||void 0),debounce=(fn,options)=>{let timer;const _options=Object.assign({leading:!0,ms:0,trailing:!0},options);return(...args)=>{!timer&&_options.leading&&fn(...args),clearTimeout(timer),timer=setTimeout(()=>{timer=void 0,_options.trailing&&fn(...args)},_options.ms)}},isReact=!1,isReactNative=!1,isWebComponents=!1,isBrowser=isWebComponents||"undefined"!=typeof document,logError=message=>{console.error(buildErrorMessage(message))},logWarning=message=>{console.warn(buildErrorMessage(message))},noop=()=>{},regExpFinderFactory=(regExp,{filter,defaultValue}={})=>value=>{let found;return value&&(""+value).replace(regExp,(_,v)=>found=v),(filter?filter(found):found)||defaultValue},throwError=message=>{throw new Error(buildErrorMessage(message))},trimRegExpFactory=(items,{border="\\s",regExpFlags}={})=>new RegExp(`^(?:${border})*(${Array.isArray(items)?items.join("|"):items})(?:${border})*$`,regExpFlags),defaultConfig={breakpoints:{xs:320,sm:640,md:768,lg:1024,xl:1280,"2xl":1536},class:"twic",domain:void 0,env:"production",handleShadowDom:noop,maxDPR:void 0,path:"",step:void 0},w=isBrowser&&window,config=isBrowser?w["~ TPCC"]||(w["~ TPCC"]=defaultConfig):defaultConfig,configBasedStyle=()=>`.twic-w>.${config.class}-background-done+div,.twic-w>.${config.class}-done+div,.twic-w>.${config.class}-poster-done+div{opacity:0 !important}.twic-w>.${config.class}-done,.twic-w>.${config.class}-poster-done{transform:none !important}`,getDataAttributeName=baseName=>`data-${config.class}-`+baseName,handleShadowDomFactory=attributeName=>{const marked=new WeakSet;return item=>{for(;item&&!marked.has(item);){marked.add(item);var parentNode=item["parentNode"];if(!parentNode&&item instanceof ShadowRoot){if("closed"===item.mode)throw new Error("cannot use TwicPics components in closed ShadowRoot");createElement({element:item,value:{elementName:"style",value:"*STYLE*"+configBasedStyle()}}),(item=item.host)&&item.setAttribute(attributeName,"")}else item=parentNode}}},ɵ0$5=handleShadowDomFactory,DEFAULT_MAX_DPR=2,setConfig=options=>{var{breakpoints:options={},debug,domain,class:_class,env,handleShadowDom,maxDPR,path}=options;config.breakpoints=Object.assign(Object.assign({},config.breakpoints),options),config.class=_class||config.class,config.domain=domain,config.env=debug?"debug":env,config.maxDPR=Math.max(1,maxDPR||DEFAULT_MAX_DPR),config.path=path,config.handleShadowDom=handleShadowDom&&isBrowser&&!isReactNative?handleShadowDomFactory(getDataAttributeName("component")):noop},rPath=/^(?:(auth|placeholder|rel)|(image|media|video)|[^:]*):(\/*)((v[0-9]+(?=[/?]))?[^?]*(\?.*)?)$/,FULL_PATH=4,MEDIA=2,QUERY=6,RESERVED=5,SPECIAL=1,VERSION$1="v1",urlInfos=(src,domain="")=>{var parsed=src&&rPath.exec(src);return{isAbsolute:src.slice(0,domain.length+1)===domain+"/",isSpecial:parsed&&void 0!==parsed[SPECIAL]}},computeTransform=({height,mode,width},transform)=>{return transform&&(width||height)?transform.replace(/(\/*\*)/g,"/"+mode+`=${mode=width||"-"}x`+(width=height||"-")).replace(/WxH/g,mode+"x"+width):transform},ɵ0$4=computeTransform,createUrl=({domain,context,inspect,output,quality,src,transform})=>{var isAbsolute=urlInfos(src,domain)["isAbsolute"],isAbsolute=isAbsolute?"media:"+src.slice((domain+"/").length):src,src=rPath.exec(isAbsolute),isMedia=src&&src[MEDIA],output=output?"/output="+output:"",isAbsolute=isMedia?src[FULL_PATH]:isAbsolute,quality=quality?"/quality="+quality:"",inspect=inspect?"/inspect":"",context=computeTransform(context,transform);return domain+"/"+(src&&(src[SPECIAL]||src[RESERVED])?""+VERSION$1+context+output+quality+inspect+"/"+(isMedia?src[MEDIA]+":"+isAbsolute:isAbsolute):`${isAbsolute}${src&&src[QUERY]?"&":"?"}twic=`+VERSION$1+context+output+inspect+quality)},finalTransform=(mode,refit)=>"cover"===mode&&void 0!==refit?"":"/*",validAnchors=["center"];for(const y of["","bottom","top"])for(const x of["","left","right"])(x||y)&&validAnchors.push(y?x?y+"-"+x:y:x);const rInvalidPath=/\?|^\/*$/,rValidAnchor=trimRegExpFactory(validAnchors),rValidDomain=/(^https?:\/\/[^/]+)\/*$/,validFetchPriorities=["high","low","auto"],rValidFetchPriority=trimRegExpFactory(validFetchPriorities),rValidIntrinsic=trimRegExpFactory("\\s*(\\d+)\\s*[x]\\s*(\\d+)\\s*"),validModes=["contain","cover"],rValidMode=trimRegExpFactory(validModes),validPlaceholders=["maincolor","meancolor","none","preview"],rValidPlaceholder=trimRegExpFactory(validPlaceholders),rValidPath=/^\/*(.+?)\/*$/,rValidRatio=trimRegExpFactory("(\\d+(?:\\.\\d+)?)(?:\\s*[\\/:]\\s*(\\d+(?:\\.\\d+)?))?|(none)"),validEnvironment=["debug","offline","production"],rValidEnvironment=trimRegExpFactory(validEnvironment),rValidZoom=trimRegExpFactory("(\\d+\\.?\\d*)|(css)",{regExpFlags:"i"}),isPositiveNumber=value=>!isNaN(value)&&0<value,ɵ0$3=isPositiveNumber,rMedia=/^((image|media|video):)?\/*/,trimOrUndefined=regExpFinderFactory(trimRegExpFactory(`(?:.|
)+?`)),trimTransformOrUndefined=trimRegExpFactory(".+?",{border:"[\\s\\/]"}),mappingBoolean={true:!0,false:!1,"":!0},parseBoolean=value=>"boolean"==typeof value?value:void 0!==value&&mappingBoolean[value.trim()],ɵ1$3=parseBoolean,rBreakPoints=/(?:@(?<breakpoint>xs|sm|md|lg|xl|2xl|\d*)\s+)?(?<value>[^@]+)/gm,parseBreakpointsFactory=(parse,_default)=>value=>{var parsedBreakPoints={0:parse(_default)},trimmed=trimOrUndefined((value||"").toString());if(trimmed)for(;null!==(match=rBreakPoints.exec(trimmed));){var{breakpoint:match,value:_value}=match.groups||{},numericBreakPoint=Number(match||"0");parsedBreakPoints[isNaN(numericBreakPoint)?config.breakpoints[match]:numericBreakPoint]=parse(_value?_value.replace(/\s*,\s*$/g,""):_default)}return parsedBreakPoints},ɵ2$1=parseBreakpointsFactory,parseNumber=value=>{var trimmed;return"number"!=typeof value&&(value=(trimmed=trimOrUndefined(value))&&Number(trimmed)),isPositiveNumber(value)?value:void 0},ɵ3$1=parseNumber,rAnchor=/\b(?:(left|right)|(bottom|top))\b/g,parseAnchor=anchor=>{var tmp,trimmed=trimOrUndefined(anchor);let x,y;if(trimmed)for(;tmp=rAnchor.exec(trimmed);)tmp[1]?x=tmp[1]:y=tmp[2];return{x:x,y:y}},parseAnchors=parseBreakpointsFactory(parseAnchor),parseAlt=value=>trimOrUndefined(value)||"",parseAnticipation=parseNumber,parseBot=value=>"string"==typeof value?value.trim():void 0,parseClass=trimOrUndefined,parseClassName=trimOrUndefined,parseDebug=parseBoolean,parseDomain=value=>{value=trimOrUndefined(value);return rValidDomain.test(value)?value.replace(rValidDomain,"$1"):void 0},parseDuration=parseNumber,parseEager=parseBoolean,parseFetchPriority=regExpFinderFactory(rValidFetchPriority),parseEnv=regExpFinderFactory(rValidEnvironment),parseFocus=value=>{value=trimOrUndefined(value);return"none"===value?void 0:value},parseFocuses=parseBreakpointsFactory(parseFocus),parseFrom=parseNumber,parseHandleShadowDom=parseBoolean,parseIntrinsic=value=>{if(value){let parsedIntrinsic;var height,value=rValidIntrinsic.exec(value);return value&&([,,value,height]=value,parsedIntrinsic=value+"x"+height),parsedIntrinsic}},parseMaxDrp=value=>{value=parseNumber(value);return 1<=value?value:void 0},parseMediaTag=value=>{value=trimOrUndefined(value);return value&&value.toLocaleLowerCase()},parseMode=regExpFinderFactory(rValidMode,{defaultValue:"cover"}),parseModes=parseBreakpointsFactory(parseMode),parsePath=value=>{value=trimOrUndefined(value);return value?value.replace(rValidPath,"$1/"):""},parsePlaceholder=placeholder=>{if("offline"!==config.env&&"none"!==placeholder)return rValidPlaceholder.test(placeholder)?placeholder:"preview"},parsePosition=trimOrUndefined,parsePositions=parseBreakpointsFactory(parsePosition),ɵ4=p=>p&&p.replace(/^\/*(.*[^/])\/*$/,"$1"),parsePreTransform=regExpFinderFactory(trimTransformOrUndefined,{filter:ɵ4}),parseRatio=value=>{if("none"===value)return 0;let number;var height;return value&&(number="number"==typeof value?1/value:(value=rValidRatio.exec(value))?([,,value,height]=value,(height?Number(height):1)/Number(value)):1),isPositiveNumber(number)?number:void 0},parseRatios=parseBreakpointsFactory(parseRatio,1),parseRefit=value=>{var parsedBoolean=parseBoolean(value);return void 0===parsedBoolean?(value=trimOrUndefined((value||"").toString()))&&value.replace(/\s/g,""):parsedBoolean?"":void 0},parseSize=value=>{value=trimOrUndefined(value);return value&&value.replace(/\n\s*/g,"")},ɵ5=parseSize,parseSizes=parseBreakpointsFactory(parseSize),parseStep=parseNumber,parseSrc=value=>{var isAbsolute,isSpecial;return"offline"!==config.env||isReactNative?(value=trimOrUndefined(value)||"placeholder:red",{isAbsolute,isSpecial}=urlInfos(value,config.domain),isSpecial?value:isAbsolute?"media:"+value.slice((config.domain+"/").length):value.replace(rMedia,"media:"+config.path)):""},parseTo=parseNumber,parseTitle=value=>value&&value.trim(),mappingTransition={true:"fade",false:"none",fade:"fade",zoom:"zoom",none:"none"},parseTransition=value=>{"boolean"!=typeof value&&(value=trimOrUndefined(value)||!0);const parsedTransition={};return String(value).split(/\s*\+\s*|\s+/).forEach(t=>parsedTransition[""+(mappingTransition[t]||"fade")]=!0),parsedTransition},parseTransitionDelay=trimOrUndefined,parseTransitionDuration=trimOrUndefined,parseTransitionTimingFunction=trimOrUndefined,parseZoom=value=>{if("string"==typeof value){var parsed=rValidZoom.exec(value);if(parsed&&parsed[3])return!0;value=parsed&&parsed[2]?Number(parsed[2]):void 0}return isPositiveNumber(value)&&1<value?value:void 0},computePosition=({x,y},mode,position)=>"contain"===mode&&(position||(y?x?y+" "+x:y:x)),ɵ0$2=computePosition,computeRefit=(anchor,mode,refit)=>void 0!==refit&&("contain"===mode?"auto":"WxH")+(refit?`(${refit})`:"")+(anchor&&"contain"!==mode?"@"+anchor:""),ɵ1$2=computeRefit,preComputeArtDirectives=(anchors,focuses,modes,positions,ratios,sizes)=>{var allBreakpoints=new Set([...Object.keys(anchors).map(Number),...Object.keys(focuses).map(Number),...Object.keys(modes).map(Number),...Object.keys(positions).map(Number),...Object.keys(ratios).map(Number),...Object.keys(sizes).map(Number)]);const resolutionsList=[...new Set([...Object.values(config.breakpoints),...Array.from(allBreakpoints).filter(w=>0<w)])].sort((a,b)=>a-b),artDirectives=Array.from(allBreakpoints).sort((a,b)=>a-b).map(breakpoint=>({breakpoint:breakpoint,anchor:anchors[breakpoint],focus:focuses[breakpoint],mode:modes[breakpoint],position:positions[breakpoint],ratio:ratios[breakpoint],sizes:sizes[breakpoint]}));for(let i=1;i<artDirectives.length;i++){var previous=artDirectives[i-1],current=artDirectives[i];for(const key of Object.keys(artDirectives[0]))current[key]||(current[key]=previous[key])}return artDirectives.map((source,index)=>{const{anchor,breakpoint,focus,mode,position,ratio,sizes}=source,nextBreakpoint=null!=(index=null==(source=artDirectives[index+1])?void 0:source.breakpoint)?index:void 0;source=breakpoint||nextBreakpoint||Math.max(...resolutionsList);return{anchor:anchor,breakpoint:breakpoint,focus:focus,media:`(min-width: ${breakpoint}px)`,mode:mode,position:position,ratio:ratio,resolutions:resolutionsList.filter(resolution=>resolution>=breakpoint&&(void 0===nextBreakpoint||resolution<nextBreakpoint||0===breakpoint&&resolution<=nextBreakpoint)),sizes:sizes,width:source,height:ratio?""+Math.round(source*ratio):void 0}}).sort((a,b)=>b.breakpoint-a.breakpoint)},ɵ2=preComputeArtDirectives,srcSetName=isReact?"srcSet":"srcset",computePicture=(anchors,eager,fetchPriority,focuses,modes,positions,preTransform,ratios,refit,sizes,src)=>{if(config.domain){const artDirectives=preComputeArtDirectives(anchors,focuses,modes,positions,ratios,sizes);anchors=artDirectives.map((artDirective,index)=>{const{anchor,focus,media,mode,position,ratio,resolutions,sizes:_sizes,width,height}=artDirective,actualMode="contain"===mode?"inside":mode;artDirective=computePosition(anchor,mode,position);const actualPreTransform=""+computePreTransform({anchor:anchor,focus:focus,mode:mode,preTransform:preTransform,refit:refit})+(finalTransform(mode,refit)||"")+(artDirective?"@"+artDirective.replace(/(\s)/g,"-"):""),actualResolutionSet=new Set;for(let dpr=1;dpr<=config.maxDPR;dpr++)resolutions.forEach(resolution=>actualResolutionSet.add(resolution*dpr));const srcMap=new Map;Array.from(actualResolutionSet).sort((a,b)=>b-a).forEach(_width=>{srcMap.set(_width,createUrl({context:{height:ratio?Math.round(_width*ratio):void 0,mode:actualMode,width:_width},domain:config.domain,transform:actualPreTransform,src:src}))});artDirective={height:height,sizes:_sizes,width:""+width};return artDirective[srcSetName]=Array.from(srcMap,([_width,_src])=>_src+` ${_width}w`).join(","),index===artDirectives.length-1?(artDirective.fetchPriority=eager?fetchPriority||"high":fetchPriority,artDirective.loading=eager?"eager":"lazy",artDirective.src=srcMap.get(width)):artDirective.media=media,artDirective});return{img:anchors.pop(),sources:anchors}}},computePreTransform=({anchor:{x,y},debug,focus,mode,preTransform,refit})=>{y=y?x?y+"-"+x:y:x,x="contain"!==mode&&void 0===refit&&(focus||y),focus=computeRefit(y,mode,refit);return(debug?"/debug":"")+(preTransform?"/"+preTransform:"")+(x?"/focus="+x:"")+(focus?"/refit="+focus:"")},preComputeStyle=(transitionDelay,transitionDuration,transitionTimingFunction)=>{var preComputedStyle={};return transitionDuration&&(preComputedStyle.transitionDuration=transitionDuration),transitionDelay&&(preComputedStyle.transitionDelay=transitionDelay),transitionTimingFunction&&(preComputedStyle.transitionTimingFunction=transitionTimingFunction),preComputedStyle},ɵ3=preComputeStyle,computeAlt=(alt,mediaTag)=>"img"===mediaTag?alt:void 0,computeData=(anchor,bot,eager,focus,intrinsic,mediaTag,mode,preTransform,refit,src,step,videoOptions)=>{var attributes={},{videoTransform:videoOptions,posterTransform}=videoOptions||{},anchor=computePreTransform({anchor:anchor,debug:"debug"===config.env,focus:focus,mode:mode,preTransform:preTransform,refit:refit});return(anchor||videoOptions)&&(attributes[getDataAttributeName("transform")]=""+anchor+(videoOptions||"")+(finalTransform(mode,refit)||"")),"string"==typeof bot&&(attributes[getDataAttributeName("bot")]=bot||"/"),eager&&(attributes[getDataAttributeName("eager")]=""),intrinsic&&(attributes[getDataAttributeName("intrinsic")]=intrinsic),src&&("img"===mediaTag||"video"===mediaTag?attributes[getDataAttributeName("src")]=src:attributes[getDataAttributeName("background")]=`url(${src})`),src&&"video"===mediaTag&&(attributes[getDataAttributeName("poster")]=src,attributes[getDataAttributeName("poster-transform")]=""+anchor+(posterTransform||"")+"/*/output=image"),void 0!==step&&(attributes[getDataAttributeName("step")]=String(step)),attributes},computePlaceholderStyle=(anchor,focus,mode,placeholder,position,preTransform,ratio,refit,src,transitions,transitionDelay,transitionDuration,transitionTimingFunction,videoOptions,placeholderDataHandler)=>{transitionDelay=preComputeStyle(transitionDelay,transitionDuration,transitionTimingFunction),placeholderDataHandler({anchor:anchor,focus:focus,mode:mode,placeholder:placeholder,preTransform:preTransform,ratio:ratio,refit:refit,src:src,transitions:transitions,videoOptions:videoOptions}),mode&&(transitionDelay.backgroundSize=mode),transitionDuration=computePosition(anchor,mode,position);return transitionDuration&&(transitionDelay.backgroundPosition=transitionDuration),transitionDelay},mappingPosition={img:"objectPosition",video:"objectPosition"},mappingMode={img:"objectFit",video:"objectFit"},computeStyle=(anchor,mediaTag,mode,position,transitionDelay,transitionDuration,transitionTimingFunction)=>{transitionDelay=preComputeStyle(transitionDelay,transitionDuration,transitionTimingFunction),transitionDuration=computePosition(anchor,mode,position);return transitionDuration&&(transitionDelay[mappingPosition[mediaTag]||"backgroundPosition"]=transitionDuration),mode&&(transitionDelay[mappingMode[mediaTag]||"backgroundSize"]=mode),transitionDelay},PLACEHOLDER_DIM=1e3,computePlaceholderBackground=(element,{anchor,focus,mode,placeholder,preTransform,src,ratio,refit,transitions,videoOptions})=>{if(!config.domain||!element||!placeholder||transitions.hasOwnProperty("zoom"))return"";transitions=getComputedStyle(element),element=mode||parseMode(transitions.backgroundSize);let _ratio,height=(_ratio=0===ratio?"contain"===element?1:cssWithoutPx(transitions.height)/Math.max(1,cssWithoutPx(transitions.width)):null!=ratio?ratio:cssWithoutPx(transitions.fontSize),PLACEHOLDER_DIM),width=PLACEHOLDER_DIM;_ratio<1?height*=_ratio:width/=_ratio;ratio=(videoOptions||{}).videoTransform,transitions=""+computePreTransform({anchor:anchor,focus:focus,mode:mode,preTransform:preTransform,refit:refit})+(ratio||"")+(finalTransform(element,refit)||"");return createUrl({context:{height:Math.max(1,Math.round(height)),mode:element,width:Math.max(1,Math.round(width))},domain:config.domain,transform:transitions,src:src,output:placeholder})},computeWrapperClass=(className,src,transitions)=>{var wrapperClass=["twic-w"];return className&&wrapperClass.push(className),transitions.hasOwnProperty("none")||(transitions.hasOwnProperty("fade")&&wrapperClass.push("twic-tf"),transitions.hasOwnProperty("zoom")&&wrapperClass.push("twic-tz")),"offline"===config.env&&(wrapperClass.push("twic-offline"),src||wrapperClass.push("twic-nosrc")),wrapperClass.join(" ")},computeWrapperStyle=ratio=>0===ratio?{height:"100%",paddingTop:"0"}:{paddingTop:void 0===ratio?"":100*ratio+"%"},computeMagnifierStyle=zoom=>{var magnifierStyle={};return"boolean"!=typeof zoom&&zoom&&(magnifierStyle["--twic-zoom"]=""+zoom),magnifierStyle},ease=(t,d)=>{return t<0||d<t?Math.min(Math.max(0,t),d):(t=2*t/d)<1?d/2*Math.pow(t,3):(t-=2,d/2*(Math.pow(t,3)+2))},ɵ0$1=ease,move=e=>{e.preventDefault(),e.stopPropagation();var currentTarget=e.currentTarget,{left,top,right,bottom}=currentTarget.getBoundingClientRect(),{clientX:e,clientY}=e instanceof MouseEvent?e:e.touches[0];currentTarget.style.setProperty("--twic-xr",ease(e-left,right-left).toString()),currentTarget.style.setProperty("--twic-yr",ease(clientY-top,bottom-top).toString())},ɵ1$1=move;var initMagnifier=magnifierContainer=>{magnifierContainer=magnifierContainer.firstElementChild;magnifierContainer.addEventListener("mousemove",e=>move(e)),magnifierContainer.addEventListener("touchmove",e=>move(e))};const attributes=(data,element,renderer)=>{element&&renderer&&Object.entries(data||[]).forEach(([n,v])=>{void 0===v?renderer.removeAttribute(element,n):renderer.setAttribute(element,n,v)})},styles=(data,element,renderer)=>{element&&renderer&&Object.entries(data||[]).forEach(([n,v])=>{void 0===v?renderer.removeStyle(element,n):renderer.setStyle(element,n,v)})};class TwicImgComponent{constructor(renderer,hostElement){this.renderer=renderer,this.hostElement=hostElement,this.mediaTag="img",this.alt=void 0,this.anchor=void 0,this.bot=void 0,this.focus=void 0,this.intrinsic=void 0,this.mode=void 0,this.placeholder=void 0,this.position=void 0,this.preTransform=void 0,this.ratio=void 0,this.step=void 0,this.title=void 0,this.transitionDelay=void 0,this.transitionDuration=void 0,this.transitionTimingFunction=void 0,this.zoom=void 0,this.stateChangeEvent=new EventEmitter,this._zoom=!1}get twicZoom(){return this._zoom}ngAfterViewInit(){this._zoom&&initMagnifier(this.hostElement.nativeElement.firstElementChild),this.updateTemplate()}onStateChange(stateEvent){this.stateChangeEvent.emit(stateEvent)}ngOnChanges(){this._zoom=parseZoom(this.zoom),this.magnifierStyle=computeMagnifierStyle(this._zoom),this.updateTemplate()}updateTemplate(){var _a;null!=(_a=this.hostElement)&&_a.nativeElement&&styles(this.magnifierStyle,this.hostElement.nativeElement,this.renderer)}}TwicImgComponent.decorators=[{type:Component,args:[{selector:"TwicImg",template:`
        <TwicMedia
            *ngIf="_zoom"
            [anchor]="anchor"
            [bot]="bot"
            className="twic-m"
            [focus]="focus"
            [intrinsic]="intrinsic"
            mode="cover"
            [eager]="eager"
            mediaTag="div"
            [placeholder]="placeholder"
            [position]="position"
            [preTransform]="preTransform"
            [ratio]="ratio"
            [refit]="refit"
            [src]="src"
            [step]="step"
            [title]="title"
            [transition]="transition"
            [transitionDelay]="transitionDelay"
            [transitionDuration]="transitionDuration"
            [transitionTimingFunction]="transitionTimingFunction"
            [ngStyle]="magnifierStyle"
        ></TwicMedia>
        <TwicMedia
            [alt]="alt"
            [anchor]="anchor"
            [bot]="bot"
            [focus]="focus"
            [intrinsic]="intrinsic"
            [mode]="mode"
            [mediaTag]="mediaTag"
            [eager]="eager"
            [placeholder]="placeholder"
            [position]="position"
            [preTransform]="preTransform"
            [ratio]="ratio"
            [refit]="refit"
            [src]="src"
            [step]="step"
            [title]="title"
            [transition]="transition"
            [transitionDelay]="transitionDelay"
            [transitionDuration]="transitionDuration"
            [transitionTimingFunction]="transitionTimingFunction"
            (stateChangeEvent)="onStateChange($event)"
        ></TwicMedia>
    `,changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,host:{class:"twic-i twic-d"}}]}],TwicImgComponent.ctorParameters=()=>[{type:Renderer2},{type:ElementRef}],TwicImgComponent.propDecorators={alt:[{type:Input}],anchor:[{type:Input}],bot:[{type:Input}],focus:[{type:Input}],intrinsic:[{type:Input}],mode:[{type:Input}],eager:[{type:Input}],placeholder:[{type:Input}],position:[{type:Input}],preTransform:[{type:Input}],ratio:[{type:Input}],refit:[{type:Input}],src:[{type:Input}],step:[{type:Input}],title:[{type:Input}],transition:[{type:Input}],transitionDelay:[{type:Input}],transitionDuration:[{type:Input}],transitionTimingFunction:[{type:Input}],zoom:[{type:Input}],stateChangeEvent:[{type:Output}],twicZoom:[{type:HostBinding,args:["class.twic-z"]}]};const debounceDelay=100,elementToObserver=new WeakMap,ɵ0=records=>{for(var{target}of records){target=elementToObserver.get(target);target&&target.handleState()}},mutationObserver=isBrowser&&"undefined"!=typeof MutationObserver&&new MutationObserver(ɵ0),ɵ1=records=>{for(var{target}of records){target=elementToObserver.get(target);target&&target.refreshBackground()}},resizeObserver=isBrowser&&"undefined"!=typeof ResizeObserver&&new ResizeObserver(ɵ1),rTwicClasses=new RegExp(`(?:\\s*)(?:${config.class}(?:-background)*-)(done|error|loading)`);class Observer{constructor(stateHandler=void 0){this.handleState=()=>{if(this.stateHandler){let state="new";var className=this.media["className"],className=rTwicClasses.exec(className);className&&([,state]=className),this.stateHandler(state)}},this.refreshBackground=debounce(()=>{var placeHolderElement,wrapperBackground;this.media&&this.placeholderData&&(placeHolderElement=this.media.nextElementSibling,wrapperBackground=computePlaceholderBackground(placeHolderElement,this.placeholderData))&&wrapperBackground!==this.savedWrapperBackground&&(this.savedWrapperBackground=wrapperBackground,placeHolderElement.style.backgroundImage=`url(${JSON.stringify(wrapperBackground)})`)},{ms:debounceDelay}),this.setMedia=media=>{media&&(config.handleShadowDom(media),this.media=media,elementToObserver.set(this.media,this),mutationObserver&&(mutationObserver.observe(this.media,{attributes:!0,attributeFilter:["class"]}),this.handleState()),resizeObserver)&&resizeObserver.observe(this.media)},this.setPlaceholderData=data=>{this.placeholderData=data,this.media&&this.refreshBackground()},this.destroy=()=>{this.media&&this.media&&resizeObserver&&resizeObserver.unobserve(this.media)},this.stateHandler=stateHandler}}const preComputeVideoOptions=(duration,from,posterFrom,to)=>({videoTransform:(from?"/from="+from:"")+(to?"/to="+to:"")+(duration?"/duration="+duration:""),posterTransform:posterFrom||from?"/from="+(void 0===posterFrom?from:posterFrom):""}),preComputePlaceholder=(placeholder,src)=>urlInfos(src,config.domain).isSpecial?void 0:placeholder;class TwicMediaComponent{constructor(renderer){this.renderer=renderer,this.alt=void 0,this.anchor=void 0,this.bot=void 0,this.className=void 0,this.focus=void 0,this.intrinsic=void 0,this.mode=void 0,this.mediaTag=void 0,this.placeholder=void 0,this.position=void 0,this.preTransform=void 0,this.ratio=void 0,this.step=void 0,this.title=void 0,this.transitionDelay=void 0,this.transitionDuration=void 0,this.transitionTimingFunction=void 0,this.videoOptions=void 0,this.stateChangeEvent=new EventEmitter,this._alt=void 0,this._anchor=void 0,this._bot=void 0,this._className=void 0,this._focus=void 0,this._intrinsic=void 0,this._mediaTag=void 0,this._mode=void 0,this._placeholder=void 0,this._position=void 0,this._preTransform=void 0,this._ratio=void 0,this._refit=void 0,this._step=void 0,this._title=void 0,this._transitionDelay=void 0,this._transitionDuration=void 0,this._transitionTimingFunct=void 0,this._placeholder_=void 0,this.observer=new Observer(state=>{this.stateChangeEvent.emit({target:this,state:state})})}ngAfterViewInit(){this._media=this.renderer.createElement(this._mediaTag),this._placeholder_?this.renderer.insertBefore(this.containerRef.nativeElement,this._media,this.placeholderRef.nativeElement):this.renderer.appendChild(this.containerRef.nativeElement,this._media),this.observer.setMedia(this._media),this.updateMedia()}ngOnChanges(){this._alt=parseAlt(this.alt),this._anchor=parseAnchor(this.anchor),this._bot=parseBot(this.bot),this._className=parseClassName(this.className),this._focus=parseFocus(this.focus),this._intrinsic=parseIntrinsic(this.intrinsic),this._mediaTag=parseMediaTag(this.mediaTag)||"img",this._mode=parseMode(this.mode),this._eager=parseEager(this.eager),this._placeholder=parsePlaceholder(this.placeholder),this._position=parsePosition(this.position),this._preTransform=parsePreTransform(this.preTransform),this._ratio=parseRatio(this.ratio),this._refit=parseRefit(this.refit),this._src=parseSrc(this.src),this._step=parseStep(this.step),this._title=parseTitle(this.title),this._transition=parseTransition(this.transition),this._transitionDelay=parseTransitionDelay(this.transitionDelay),this._transitionDuration=parseTransitionDuration(this.transitionDuration),this._transitionTimingFunct=parseTransitionTimingFunction(this.transitionTimingFunction),this._placeholder_=preComputePlaceholder(this._placeholder,this._src),this.description=computeAlt(this._alt,this._mediaTag),this.mediaAttributes=Object.assign({},computeData(this._anchor,this._bot,this._eager,this._focus,this._intrinsic,this._mediaTag,this._mode,this._preTransform,this._refit,this._src,this._step,this.videoOptions)),this.mediaStyle=computeStyle(this._anchor,this._mediaTag,this._mode,this._position,this._transitionDelay,this._transitionDuration,this._transitionTimingFunct),this.placeholderStyle=computePlaceholderStyle(this._anchor,this._focus,this._mode,this._placeholder_,this._position,this._preTransform,this._ratio,this._refit,this._src,this._transition,this._transitionDelay,this._transitionDuration,this._transitionTimingFunct,this.videoOptions,this.observer.setPlaceholderData),this.wrapperClass=computeWrapperClass(this._className,this.src,this._transition),this.wrapperStyle=computeWrapperStyle(this._ratio),this.updateMedia()}ngOnDestroy(){this.observer.destroy()}updateMedia(){this._media&&(this.mediaAttributes.alt=this.description,attributes(this.mediaAttributes,this._media,this.renderer),styles(this.mediaStyle,this._media,this.renderer))}}TwicMediaComponent.decorators=[{type:Component,args:[{selector:"TwicMedia",template:`
        <div
            #container
            [ngClass]="wrapperClass"
            [ngStyle]="wrapperStyle"
            [attr.title]="_title"
        >
            <div
                *ngIf="_placeholder_"
                #placeholderElement
                [ngStyle]="placeholderStyle"
            ></div>
        </div>
    `,changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,host:{ngSkipHydration:"true"},styles:['.twic-i{overflow:hidden}.twic-w,.twic-w *{border:none;margin:0;overflow:hidden;padding:0}.twic-w{overflow:hidden;padding-top:100%;padding-top:calc(100%/var(--twic-ratio, 1));position:relative;width:100%}.twic-w>*{-o-object-fit:cover;-o-object-fit:var(--twic-mode,cover);-o-object-position:center;-o-object-position:var(--twic-position,center);display:block;height:100%;left:0;object-fit:cover;object-fit:var(--twic-mode,cover);object-position:center;object-position:var(--twic-position,center);position:absolute;top:0;transition-delay:0s;transition-delay:var(--twic-transition-delay,0s);transition-duration:.4s;transition-duration:var(--twic-transition-duration,.4s);transition-property:opacity,transform;transition-timing-function:ease;transition-timing-function:var(--twic-transition-timing-function,ease);width:100%;will-change:opacity,transform}.twic-w>*,.twic-w>div{background-position:50%;background-repeat:no-repeat;background-size:cover}.twic-w>div{background-position:var(--twic-position,center);background-size:var(--twic-mode,cover);font-size:calc(1px/var(--twic-ratio, 1))}.twic-w>img:not([src]),.twic-w>img[src=""]{visibility:hidden}.twic-w.twic-tz>img{transform:scale(0)}.twic-w.twic-tf>div{opacity:1}.twic-d{display:block}.twic-offline{background-color:#ccc}.twic-offline.twic-nosrc{background-color:#fd0016}.twic-offline>*{display:none}:root{--twic-zoom:0}.twic-z{position:relative}.twic-m{left:0;position:absolute;top:0;z-index:1}.twic-m>*{display:none;height:calc(max(var(--twic-zoom), 1)*100%);transform:translate3d(calc((1 - max(var(--twic-zoom), 1))*var(--twic-xr, 0)*1px),calc((1 - max(var(--twic-zoom), 1))*var(--twic-yr, 0)*1px),0);transition:none;width:calc(max(var(--twic-zoom), 1)*100%)}.twic-m:hover>*{display:block}.twic-m:hover+div,twicmedia:hover+twicmedia{opacity:0}.twic-p{border:none;margin:0;overflow:hidden;padding:0}.twic-p>img{-o-object-fit:cover;-o-object-position:center;display:block;height:100%;object-fit:cover;object-position:center;width:100%}']}]}],TwicMediaComponent.ctorParameters=()=>[{type:Renderer2}],TwicMediaComponent.propDecorators={alt:[{type:Input}],anchor:[{type:Input}],bot:[{type:Input}],className:[{type:Input}],focus:[{type:Input}],intrinsic:[{type:Input}],mode:[{type:Input}],mediaTag:[{type:Input}],eager:[{type:Input}],placeholder:[{type:Input}],position:[{type:Input}],preTransform:[{type:Input}],ratio:[{type:Input}],refit:[{type:Input}],src:[{type:Input}],step:[{type:Input}],title:[{type:Input}],transition:[{type:Input}],transitionDelay:[{type:Input}],transitionDuration:[{type:Input}],transitionTimingFunction:[{type:Input}],videoOptions:[{type:Input}],stateChangeEvent:[{type:Output}],containerRef:[{type:ViewChild,args:["container",{static:!0}]}],placeholderRef:[{type:ViewChild,args:["placeholderElement",{static:!1}]}]};class TwicPictureComponent{constructor(renderer){this.renderer=renderer,this.alt=void 0,this.anchor=void 0,this.fetchpriority=void 0,this.focus=void 0,this.mode=void 0,this.position=void 0,this.preTransform=void 0,this.ratio=void 0,this.title=void 0,this._alt=void 0,this._anchors=void 0,this._fetchpriority=void 0,this._focuses=void 0,this._modes=void 0,this._positions=void 0,this._preTransform=void 0,this._ratios=void 0,this._refit=void 0,this._sizes=void 0,this._sources=[],this._title=void 0}ngAfterViewInit(){var _a;null!=(_a=this.pictureData)&&_a.sources&&(this._sources=this.pictureData.sources.map(_=>{var _source=this.renderer.createElement("source");return this.renderer.insertBefore(this.containerRef.nativeElement,_source,this.imageRef.nativeElement),_source})),this.updateMedia()}ngOnChanges(){this._alt=parseAlt(this.alt),this._anchors=parseAnchors(this.anchor),this._focuses=parseFocuses(this.focus),this._modes=parseModes(this.mode),this._eager=parseEager(this.eager),this._positions=parsePositions(this.position),this._preTransform=parsePreTransform(this.preTransform),this._ratios=parseRatios(this.ratio),this._refit=parseRefit(this.refit),this._sizes=parseSizes(this.sizes),this._src=parseSrc(this.src),this._title=parseTitle(this.title),this.description=computeAlt(this._alt,"img"),this.pictureData=Object.assign({},computePicture(this._anchors,this._eager,this._fetchpriority,this._focuses,this._modes,this._positions,this._preTransform,this._ratios,this._refit,this._sizes,this._src)),this.updateMedia()}updateMedia(){var _a,_b;this.imageRef.nativeElement&&attributes(null==(_a=this.pictureData)?void 0:_a.img,this.imageRef.nativeElement,this.renderer);for(const index in this._sources){var actualSourceElement=this._sources[index];attributes(null==(_b=this.pictureData)?void 0:_b.sources[index],actualSourceElement,this.renderer)}}}TwicPictureComponent.decorators=[{type:Component,args:[{selector:"TwicPicture",template:`
      <picture
          #container
          class="twic-p"
          [attr.title]="_title"
      >
        <img #image [attr.alt]="description"/>
      </picture>
  `,changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,host:{ngSkipHydration:"true"},styles:['.twic-i{overflow:hidden}.twic-w,.twic-w *{border:none;margin:0;overflow:hidden;padding:0}.twic-w{overflow:hidden;padding-top:100%;padding-top:calc(100%/var(--twic-ratio, 1));position:relative;width:100%}.twic-w>*{-o-object-fit:cover;-o-object-fit:var(--twic-mode,cover);-o-object-position:center;-o-object-position:var(--twic-position,center);display:block;height:100%;left:0;object-fit:cover;object-fit:var(--twic-mode,cover);object-position:center;object-position:var(--twic-position,center);position:absolute;top:0;transition-delay:0s;transition-delay:var(--twic-transition-delay,0s);transition-duration:.4s;transition-duration:var(--twic-transition-duration,.4s);transition-property:opacity,transform;transition-timing-function:ease;transition-timing-function:var(--twic-transition-timing-function,ease);width:100%;will-change:opacity,transform}.twic-w>*,.twic-w>div{background-position:50%;background-repeat:no-repeat;background-size:cover}.twic-w>div{background-position:var(--twic-position,center);background-size:var(--twic-mode,cover);font-size:calc(1px/var(--twic-ratio, 1))}.twic-w>img:not([src]),.twic-w>img[src=""]{visibility:hidden}.twic-w.twic-tz>img{transform:scale(0)}.twic-w.twic-tf>div{opacity:1}.twic-d{display:block}.twic-offline{background-color:#ccc}.twic-offline.twic-nosrc{background-color:#fd0016}.twic-offline>*{display:none}:root{--twic-zoom:0}.twic-z{position:relative}.twic-m{left:0;position:absolute;top:0;z-index:1}.twic-m>*{display:none;height:calc(max(var(--twic-zoom), 1)*100%);transform:translate3d(calc((1 - max(var(--twic-zoom), 1))*var(--twic-xr, 0)*1px),calc((1 - max(var(--twic-zoom), 1))*var(--twic-yr, 0)*1px),0);transition:none;width:calc(max(var(--twic-zoom), 1)*100%)}.twic-m:hover>*{display:block}.twic-m:hover+div,twicmedia:hover+twicmedia{opacity:0}.twic-p{border:none;margin:0;overflow:hidden;padding:0}.twic-p>img{-o-object-fit:cover;-o-object-position:center;display:block;height:100%;object-fit:cover;object-position:center;width:100%}']}]}],TwicPictureComponent.ctorParameters=()=>[{type:Renderer2}],TwicPictureComponent.propDecorators={alt:[{type:Input}],anchor:[{type:Input}],eager:[{type:Input}],fetchpriority:[{type:Input}],focus:[{type:Input}],mode:[{type:Input}],position:[{type:Input}],preTransform:[{type:Input}],ratio:[{type:Input}],refit:[{type:Input}],sizes:[{type:Input}],src:[{type:Input}],title:[{type:Input}],containerRef:[{type:ViewChild,args:["container",{static:!0}]}],imageRef:[{type:ViewChild,args:["image",{static:!0}]}]};class TwicVideoComponent{constructor(){this.mediaTag="video",this.anchor=void 0,this.bot=void 0,this.duration=void 0,this.focus=void 0,this.from=void 0,this.intrinsic=void 0,this.mode=void 0,this.placeholder=void 0,this.position=void 0,this.posterFrom=void 0,this.preTransform=void 0,this.ratio=void 0,this.step=void 0,this.title=void 0,this.to=void 0,this.transitionDelay=void 0,this.transitionDuration=void 0,this.transitionTimingFunction=void 0,this.stateChangeEvent=new EventEmitter}ngOnChanges(){this._duration=parseDuration(this.duration),this._from=parseFrom(this.from),this._posterFrom=parseDuration(this.posterFrom),this._to=parseTo(this.to),this.videoOption=preComputeVideoOptions(this._duration,this._from,this._posterFrom,this._to)}onStateChange(stateEvent){this.stateChangeEvent.emit(stateEvent)}}TwicVideoComponent.decorators=[{type:Component,args:[{selector:"TwicVideo",template:`
        <TwicMedia
            [anchor]="anchor"
            [bot]="bot"
            [focus]="focus"
            [intrinsic]="intrinsic"
            [mode]="mode"
            [mediaTag]="mediaTag"
            [eager]="eager"
            [placeholder]="placeholder"
            [position]="position"
            [preTransform]="preTransform"
            [ratio]="ratio"
            [src]="src"
            [step]="step"
            [title]="title"
            [transition]="transition"
            [transitionDelay]="transitionDelay"
            [transitionDuration]="transitionDuration"
            [transitionTimingFunction]="transitionTimingFunction"
            [videoOptions]="videoOption"
            (stateChangeEvent)="onStateChange($event)"
        ></TwicMedia>
    `,changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,host:{class:"twic-i twic-d"}}]}],TwicVideoComponent.propDecorators={anchor:[{type:Input}],bot:[{type:Input}],duration:[{type:Input}],focus:[{type:Input}],from:[{type:Input}],intrinsic:[{type:Input}],mode:[{type:Input}],eager:[{type:Input}],placeholder:[{type:Input}],position:[{type:Input}],posterFrom:[{type:Input}],preTransform:[{type:Input}],ratio:[{type:Input}],src:[{type:Input}],step:[{type:Input}],title:[{type:Input}],to:[{type:Input}],transition:[{type:Input}],transitionDelay:[{type:Input}],transitionDuration:[{type:Input}],transitionTimingFunction:[{type:Input}],stateChangeEvent:[{type:Output}]};class TwicViewComponent{constructor(renderer,elementRef){this.renderer=renderer,this.elementRef=elementRef}ngOnInit(){this.renderer.setAttribute(this.elementRef.nativeElement,getDataAttributeName("view"),"")}}TwicViewComponent.decorators=[{type:Component,args:[{selector:"TwicView",template:"<ng-content></ng-content>"}]}],TwicViewComponent.ctorParameters=()=>[{type:Renderer2},{type:ElementRef}];class TwicPicsComponentsModule{}TwicPicsComponentsModule.decorators=[{type:NgModule,args:[{declarations:[TwicBackgroundComponent,TwicImgComponent,TwicMediaComponent,TwicPictureComponent,TwicVideoComponent,TwicViewComponent],imports:[CommonModule],exports:[TwicBackgroundComponent,TwicImgComponent,TwicPictureComponent,TwicVideoComponent,TwicViewComponent]}]}];const VERSION="v1",parametersMap=[["anticipation","anticipation"],["class","class"],["maxDPR","max-dpr"],["step","step"]],register=options=>{if(isBrowser&&!isReactNative){const parts=[config.domain+"/?"+VERSION];parametersMap.forEach(p=>{var[p,actualKey]=p;options.hasOwnProperty(p)&&options[p]&&parts.push(actualKey+"="+options[p])});var scriptElementId=options["scriptElementId"];createElement({element:document.head,value:[{attributes:{rel:"preconnect",href:config.domain},elementName:"link"},{attributes:Object.assign(Object.assign({async:"",defer:""},scriptElementId&&{id:scriptElementId}),{src:parts.join("&")}),elementName:"script"}]});const style=createElement({elementName:"style",value:configBasedStyle()});document.head.appendChild(style),document.addEventListener("astro:after-swap",()=>document.head.appendChild(style))}},validate=options=>{options||throwError("install options not provided");var{domain:options,env,path}=options;options&&rValidDomain.test(options)||throwError(`install domain "${options}" is invalid`),path&&rInvalidPath.test(path)&&throwError(`install path "${path}" is invalid`),env&&!rValidEnvironment.test(env)&&throwError(`install env "${env}" is invalid`)},installTwicPics=options=>{validate(options);var{domain,env,path}=options;setConfig(Object.assign(Object.assign({},options),{domain:parseDomain(domain),env:parseEnv(env),path:parsePath(path)})),register(options)},installTwicpics=installTwicPics;export{TwicBackgroundComponent,TwicImgComponent,TwicMediaComponent,TwicPicsComponentsModule,TwicPictureComponent,TwicVideoComponent,TwicViewComponent,installTwicPics,installTwicpics};
//# sourceMappingURL=module.js.map