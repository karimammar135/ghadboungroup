const t=e=>{if(!e){return undefined}const{attributes:n,element:o,elementName:s,value:i}=e;const r=o||document.createElement(s||`div`);if(n&&r instanceof HTMLElement){for(const[t,e]of Object.entries(n)){r.setAttribute(t,String(e))}}if(i){if(typeof i===`string`){r.innerHTML=i}else{for(const e of Array.isArray(i)?i:[i]){const n=t(e);if(n){r.appendChild(n)}}}}return r};const e=/px$/;const n=t=>Number(t.replace(e,``));const o=t=>`twicpics-components ${t}`;const s=(t,e)=>{let n;const o=Object.assign({leading:true,ms:0,trailing:true},e);return(...e)=>{if(!n&&o.leading){t(...e)}clearTimeout(n);n=setTimeout((()=>{n=undefined;if(o.trailing){t(...e)}}),o.ms)}};const i="SVELTEKIT"===`react-native`;const r="SVELTEKIT"===`webcomponents`;const c=typeof document!==`undefined`;const a=()=>undefined;const d=(t,{filter:e,defaultValue:n}={})=>o=>{let s;if(o){`${o}`.replace(t,((t,e)=>s=e))}return(e?e(s):s)||n};const f=t=>{throw new Error(o(t))};const u=(t,{border:e=`\\s`,regExpFlags:n}={})=>new RegExp(`^(?:${e})*(${Array.isArray(t)?t.join(`|`):t})(?:${e})*$`,n);const l={breakpoints:{xs:320,sm:640,md:768,lg:1024,xl:1280,"2xl":1536},class:`twic`,domain:undefined,env:`production`,handleShadowDom:a,maxDPR:undefined,path:``,step:undefined};const m=c&&window;const p=c?m[`~ TPCC`]||(m[`~ TPCC`]=l):l;const h=()=>`.twic-w>.${p.class}-background-done+div,.twic-w>.${p.class}-done+div,.twic-w>.${p.class}-poster-done+div{opacity:0 !important}.twic-w>.${p.class}-done,.twic-w>.${p.class}-poster-done{transform:none !important}`;const $=t=>`data-${p.class}-${t}`;const g=e=>{const n=new WeakSet;return o=>{while(o&&!n.has(o)){n.add(o);const{parentNode:s}=o;const i=!s&&o instanceof ShadowRoot;if(i){if(o.mode===`closed`){throw new Error(`cannot use TwicPics components in closed ShadowRoot`)}t({element:o,value:{elementName:`style`,value:`*STYLE*${h()}`}});o=o.host;if(o){o.setAttribute(e,``)}}else{o=s}}}};const b=2;const w=t=>{const{breakpoints:e={},debug:n,domain:o,class:s,env:r,handleShadowDom:d,maxDPR:f,path:u}=t;p.breakpoints=Object.assign(Object.assign({},p.breakpoints),e);p.class=s||p.class;p.domain=o;p.env=n?`debug`:r;p.maxDPR=Math.max(1,f||b);p.path=u;p.handleShadowDom=d&&c&&!i?g($(`component`)):a};const v=/^(?:(auth|placeholder|rel)|(image|media|video)|[^:]*):(\/*)((v[0-9]+(?=[/?]))?[^?]*(\?.*)?)$/;const y=4;const x=2;const k=6;const S=5;const O=1;const j=`v1`;const T=(t,e=``)=>{const n=t&&v.exec(t);return{isAbsolute:t.slice(0,e.length+1)===`${e}/`,isSpecial:n&&n[O]!==undefined}};const E=({height:t,mode:e,width:n},o)=>{if(o&&(n||t)){const s=t||`-`;const i=n||`-`;return o.replace(/(\/*\*)/g,`/${`${e}=${i}x${s}`}`).replace(/WxH/g,`${i}x${s}`)}return o};const N=({domain:t,context:e,inspect:n,output:o,quality:s,src:i,transform:r})=>{const{isAbsolute:c}=T(i,t);const a=c?`media:${i.slice(`${t}/`.length)}`:i;const d=v.exec(a);const f=d&&d[x];const u=o?`/output=${o}`:``;const l=f?d[y]:a;const m=s?`/quality=${s}`:``;const p=n?`/inspect`:``;const h=E(e,r);return`${t}/${d&&(d[O]||d[S])?`${j}${h}${u}${m}${p}/${f?`${d[x]}:${l}`:l}`:`${l}${d&&d[k]?`&`:`?`}twic=${j}${h}${u}${p}${m}`}`};const M=(t,e)=>t===`cover`&&e!==undefined?``:`/*`;const P=[`center`];for(const t of[``,`bottom`,`top`]){for(const e of[``,`left`,`right`]){if(e||t){P.push(t?e?`${t}-${e}`:t:e)}}}const z=/\?|^\/*$/;u(P);const D=/(^https?:\/\/[^/]+)\/*$/;const A=[`high`,`low`,`auto`];const C=u(A);const R=u(`\\s*(\\d+)\\s*[x]\\s*(\\d+)\\s*`);const L=[`contain`,`cover`];const H=u(L);const B=[`maincolor`,`meancolor`,`none`,`preview`];const F=u(B);const W=/^\/*(.+?)\/*$/;const I=u(`(\\d+(?:\\.\\d+)?)(?:\\s*[\\/:]\\s*(\\d+(?:\\.\\d+)?))?|(none)`);const V=[`debug`,`offline`,`production`];const q=u(V);const K=u(`(\\d+\\.?\\d*)|(css)`,{regExpFlags:`i`});const Y=t=>!isNaN(t)&&t>0;const Z=/^((image|media|video):)?\/*/;const J=d(u(`(?:.|\n)+?`));const X=u(`.+?`,{border:`[\\s\\/]`});const G={true:true,false:false,"":true};const Q=t=>{if(typeof t===`boolean`){return t}if(t===undefined){return false}return G[t.trim()]};const U=/(?:@(?<breakpoint>xs|sm|md|lg|xl|2xl|\d*)\s+)?(?<value>[^@]+)/gm;const _=(t,e)=>n=>{const o={0:t(e)};const s=J((n||``).toString());if(s){let n;while((n=U.exec(s))!==null){const{breakpoint:s,value:i}=n.groups||{};const r=Number(s||`0`);o[isNaN(r)?p.breakpoints[s]:r]=t(i?i.replace(/\s*,\s*$/g,``):e)}}return o};const tt=t=>{if(typeof t!==`number`){const e=J(t);t=e&&Number(e)}return Y(t)?t:undefined};const et=/\b(?:(left|right)|(bottom|top))\b/g;const nt=t=>{const e=J(t);let n;let o;if(e){let t;while(t=et.exec(e)){if(t[1]){n=t[1]}else{o=t[2]}}}return{x:n,y:o}};const ot=_(nt);const st=t=>J(t)||``;const it=t=>typeof t===`string`?t.trim():undefined;const rt=J;const ct=t=>{const e=J(t);return D.test(e)?e.replace(D,`$1`):undefined};const at=tt;const dt=Q;const ft=d(C);const ut=d(q);const lt=t=>{const e=J(t);return e===`none`?undefined:e};const mt=_(lt);const pt=tt;const ht=t=>{if(!t){return undefined}let e;const n=R.exec(t);if(n){const[,,t,o]=n;e=`${t}x${o}`}return e};const $t=t=>{const e=J(t);return e&&e.toLocaleLowerCase()};const gt=d(H,{defaultValue:`cover`});const bt=_(gt);const wt=t=>{const e=J(t);return e?e.replace(W,`$1/`):``};const vt=t=>{if(p.env===`offline`||t===`none`){return undefined}return F.test(t)?t:`preview`};const yt=J;const xt=_(yt);const kt=d(X,{filter:t=>t&&t.replace(/^\/*(.*[^/])\/*$/,`$1`)});const St=t=>{if(t===`none`){return 0}let e;if(t){if(typeof t===`number`){e=1/t}else{const n=I.exec(t);if(n){const[,,t,o]=n;e=(o?Number(o):1)/Number(t)}else{e=1}}}return Y(e)?e:undefined};const Ot=_(St,1);const jt=t=>{const e=Q(t);if(e===undefined){const e=J((t||``).toString());return e&&e.replace(/\s/g,``)}return e?``:undefined};const Tt=t=>{const e=J(t);return e&&e.replace(/\n\s*/g,``)};const Et=_(Tt);const Nt=tt;const Mt=t=>{if(p.env===`offline`&&!i){return``}const e=J(t)||`placeholder:red`;const{isAbsolute:n,isSpecial:o}=T(e,p.domain);return o?e:n?`media:${e.slice(`${p.domain}/`.length)}`:e.replace(Z,`media:${p.path}`)};const Pt=tt;const zt=t=>t&&t.trim();const Dt={true:`fade`,false:`none`,fade:`fade`,zoom:`zoom`,none:`none`};const At=t=>{if(typeof t!==`boolean`){t=J(t)||true}const e={};String(t).split(/\s*\+\s*|\s+/).forEach((t=>e[`${Dt[t]||`fade`}`]=true));return e};const Ct=J;const Rt=J;const Lt=J;const Ht=t=>{if(typeof t===`string`){const e=K.exec(t);if(e&&e[3]){return true}t=e&&e[2]?Number(e[2]):undefined}return Y(t)?t>1?t:undefined:undefined};const Bt=({x:t,y:e},n,o)=>n===`contain`&&(o||(e?t?`${e} ${t}`:e:t));const Ft=(t,e,n)=>n!==undefined&&`${e===`contain`?`auto`:`WxH`}${n?`(${n})`:``}${t&&e!==`contain`?`@${t}`:``}`;const Wt=(t,e,n,o,s,i)=>{const r=new Set([...Object.keys(t).map(Number),...Object.keys(e).map(Number),...Object.keys(n).map(Number),...Object.keys(o).map(Number),...Object.keys(s).map(Number),...Object.keys(i).map(Number)]);const c=[...new Set([...Object.values(p.breakpoints),...Array.from(r).filter((t=>t>0))])].sort(((t,e)=>t-e));const a=Array.from(r).sort(((t,e)=>t-e)).map((r=>({breakpoint:r,anchor:t[r],focus:e[r],mode:n[r],position:o[r],ratio:s[r],sizes:i[r]})));for(let t=1;t<a.length;t++){const e=a[t-1];const n=a[t];for(const t of Object.keys(a[0])){n[t]||(n[t]=e[t])}}return a.map(((t,e)=>{var n,o;const{anchor:s,breakpoint:i,focus:r,mode:d,position:f,ratio:u,sizes:l}=t;const m=(o=(n=a[e+1])===null||n===void 0?void 0:n.breakpoint)!==null&&o!==void 0?o:undefined;const p=i||m||Math.max(...c);return{anchor:s,breakpoint:i,focus:r,media:`(min-width: ${i}px)`,mode:d,position:f,ratio:u,resolutions:c.filter((t=>t>=i&&(m===undefined||t<m||i===0&&t<=m))),sizes:l,width:p,height:u?`${Math.round(p*u)}`:undefined}})).sort(((t,e)=>e.breakpoint-t.breakpoint))};const It=`srcset`;const Vt=(t,e,n,o,s,i,r,c,a,d,f)=>{if(!p.domain){return undefined}const u=Wt(t,o,s,i,c,d);const l=u.map(((t,o)=>{const{anchor:s,focus:i,media:c,mode:d,position:l,ratio:m,resolutions:h,sizes:$,width:g,height:b}=t;const w=d===`contain`?`inside`:d;const v=Bt(s,d,l);const y=`${qt({anchor:s,focus:i,mode:d,preTransform:r,refit:a})}${M(d,a)||``}${v?`@${v.replace(/(\s)/g,`-`)}`:``}`;const x=new Set;for(let t=1;t<=p.maxDPR;t++){h.forEach((e=>x.add(e*t)))}const k=new Map;Array.from(x).sort(((t,e)=>e-t)).forEach((t=>{k.set(t,N({context:{height:m?Math.round(t*m):undefined,mode:w,width:t},domain:p.domain,transform:y,src:f}))}));const S={height:b,sizes:$,width:`${g}`};S[It]=Array.from(k,(([t,e])=>`${e} ${t}w`)).join(`,`);if(o===u.length-1){S[`fetchPriority`]=e?n||`high`:n;S[`loading`]=e?`eager`:`lazy`;S[`src`]=k.get(g)}else{S[`media`]=c}return S}));return{img:l.pop(),sources:l}};const qt=({anchor:{x:t,y:e},debug:n,focus:o,mode:s,preTransform:i,refit:r})=>{const c=e?t?`${e}-${t}`:e:t;const a=s!==`contain`&&r===undefined&&(o||c);const d=Ft(c,s,r);return`${n?`/debug`:``}${i?`/${i}`:``}${a?`/focus=${a}`:``}${d?`/refit=${d}`:``}`};const Kt=(t,e,n)=>{const o={};if(e){o[`transitionDuration`]=e}if(t){o[`transitionDelay`]=t}if(n){o[`transitionTimingFunction`]=n}return o};const Yt=(t,e)=>e===`img`?t:undefined;const Zt=(t,e,n,o,s,i,r,c,a,d,f,u)=>{const l={};const{videoTransform:m,posterTransform:h}=u||{};const g=qt({anchor:t,debug:p.env===`debug`,focus:o,mode:r,preTransform:c,refit:a});if(g||m){l[$(`transform`)]=`${g}${m||``}${M(r,a)||``}`}if(typeof e===`string`){l[$(`bot`)]=e||`/`}if(n){l[$(`eager`)]=``}if(s){l[$(`intrinsic`)]=s}if(d){if(i===`img`||i===`video`){l[$(`src`)]=d}else{l[$(`background`)]=`url(${d})`}}if(d&&i===`video`){l[$(`poster`)]=d;l[$(`poster-transform`)]=`${g}${h||``}${`/*/output=image`}`}if(f!==undefined){l[$(`step`)]=String(f)}return l};const Jt=(t,e,n,o,s,i,r,c,a,d,f,u,l,m,p)=>{const h=Kt(f,u,l);p({anchor:t,focus:e,mode:n,placeholder:o,preTransform:i,ratio:r,refit:c,src:a,transitions:d,videoOptions:m});if(n){h[`backgroundSize`]=n}const $=Bt(t,n,s);if($){h[`backgroundPosition`]=$}return h};const Xt={img:`objectPosition`,video:`objectPosition`};const Gt={img:`objectFit`,video:`objectFit`};const Qt=(t,e,n,o,s,i,r)=>{const c=Kt(s,i,r);const a=Bt(t,n,o);if(a){c[Xt[e]||`backgroundPosition`]=a}if(n){c[Gt[e]||`backgroundSize`]=n}return c};const Ut=1e3;const _t=(t,{anchor:e,focus:o,mode:s,placeholder:i,preTransform:r,src:c,ratio:a,refit:d,transitions:f,videoOptions:u})=>{if(!p.domain||!t||!i||f.hasOwnProperty(`zoom`)){return``}const l=getComputedStyle(t);const m=s||gt(l.backgroundSize);let h;if(a===0){h=m===`contain`?1:n(l.height)/Math.max(1,n(l.width))}else{h=a!==null&&a!==void 0?a:n(l.fontSize)}let $=Ut;let g=Ut;if(h<1){$*=h}else{g/=h}const{videoTransform:b}=u||{};const w=`${qt({anchor:e,focus:o,mode:s,preTransform:r,refit:d})}${b||``}${M(m,d)||``}`;return N({context:{height:Math.max(1,Math.round($)),mode:m,width:Math.max(1,Math.round(g))},domain:p.domain,transform:w,src:c,output:i})};const te=(t,e,n)=>{const o=[`twic-w`];if(t){o.push(t)}if(!n.hasOwnProperty(`none`)){if(n.hasOwnProperty(`fade`)){o.push(`twic-tf`)}if(n.hasOwnProperty(`zoom`)){o.push(`twic-tz`)}}if(p.env===`offline`){o.push(`twic-offline`);if(!e){o.push(`twic-nosrc`)}}return o.join(` `)};const ee=t=>t===0?{height:`100%`,paddingTop:`0`}:{paddingTop:t===undefined?``:`${t*100}%`};const ne=t=>{const e={};if(typeof t!==`boolean`&&t){e[`--twic-zoom`]=`${t}`}return e};const oe=`v1`;const se=[[`anticipation`,`anticipation`],[`class`,`class`],[`maxDPR`,`max-dpr`],[`step`,`step`]];const ie=e=>{if(c&&!i){const n=[`${p.domain}/?${oe}`];se.forEach((t=>{const[o,s]=t;if(e.hasOwnProperty(o)){const t=e[o];if(t){n.push(`${s}=${e[o]}`)}}}));const{scriptElementId:o}=e;t({element:document.head,value:[{attributes:{rel:`preconnect`,href:p.domain},elementName:`link`},{attributes:Object.assign(Object.assign({async:``,defer:``},o&&{id:o}),{src:n.join(`&`)}),elementName:`script`}]});const s=t({elementName:`style`,value:h()});document.head.appendChild(s);document.addEventListener(`astro:after-swap`,(()=>document.head.appendChild(s)))}};const re=t=>{if(!t){f(`install options not provided`)}const{domain:e,env:n,path:o}=t;if(!e||!D.test(e)){f(`install domain "${e}" is invalid`)}if(o&&z.test(o)){f(`install path "${o}" is invalid`)}if(n&&!q.test(n)){f(`install env "${n}" is invalid`)}};const ce=t=>{re(t);const{domain:e,env:n,path:o}=t;w(Object.assign(Object.assign({},t),{domain:ct(e),env:ut(n),path:wt(o)}));ie(t)};const ae=(t,e)=>{if(t<0||t>e){return Math.min(Math.max(0,t),e)}let n=2*t/e;if(n<1){return e/2*Math.pow(n,3)}n-=2;return e/2*(Math.pow(n,3)+2)};const de=t=>{t.preventDefault();t.stopPropagation();const e=t.currentTarget;const{left:n,top:o,right:s,bottom:i}=e.getBoundingClientRect();const{clientX:r,clientY:c}=t instanceof MouseEvent?t:t.touches[0];e.style.setProperty(`--twic-xr`,ae(r-n,s-n).toString());e.style.setProperty(`--twic-yr`,ae(c-o,i-o).toString())};var fe=t=>{const e=t.firstElementChild;e.addEventListener(`mousemove`,(t=>de(t)));e.addEventListener(`touchmove`,(t=>de(t)))};const ue=100;const le=new WeakMap;const me=c&&typeof MutationObserver!==`undefined`&&new MutationObserver((t=>{for(const{target:e}of t){const t=le.get(e);if(t){t.handleState()}}}));const pe=c&&typeof ResizeObserver!==`undefined`&&new ResizeObserver((t=>{for(const{target:e}of t){const t=le.get(e);if(t){t.refreshBackground()}}}));const he=new RegExp(`(?:\\s*)(?:${p.class}(?:-background)*-)(done|error|loading)`);class $e{constructor(t=undefined){this.handleState=()=>{if(this.stateHandler){let t=`new`;const{className:e}=this.media;const n=he.exec(e);if(n){[,t]=n}this.stateHandler(t)}};this.refreshBackground=s((()=>{if(this.media&&this.placeholderData){const t=this.media.nextElementSibling;const e=_t(t,this.placeholderData);if(e&&e!==this.savedWrapperBackground){this.savedWrapperBackground=e;t.style.backgroundImage=`url(${JSON.stringify(e)})`}}}),{ms:ue});this.setMedia=t=>{if(t){p.handleShadowDom(t);this.media=t;le.set(this.media,this);if(me){me.observe(this.media,{attributes:true,attributeFilter:[`class`]});this.handleState()}if(pe){pe.observe(this.media)}}};this.setPlaceholderData=t=>{this.placeholderData=t;if(this.media){this.refreshBackground()}};this.destroy=()=>{if(this.media){if(this.media&&pe){pe.unobserve(this.media)}}};this.stateHandler=t}}const ge=(t,e,n,o)=>({videoTransform:`${e?`/from=${e}`:``}${o?`/to=${o}`:``}${t?`/duration=${t}`:``}`,posterTransform:`${n||e?`/from=${n===undefined?e:n}`:``}`});const be=(t,e)=>T(e,p.domain).isSpecial?undefined:t;const we=()=>undefined;const ve=t=>Object.keys(t).length?Object.entries(t).flatMap((([t,e])=>e?[`${t.replace(/([a-z]|(?=[A-Z]))([A-Z])/g,`$1-$2`).toLowerCase()}:${e};`]:[])).join(``):undefined;export{$e as Observer,Yt as computeAlt,Zt as computeData,ne as computeMagnifierStyle,Vt as computePicture,Jt as computePlaceholderStyle,Qt as computeStyle,te as computeWrapperClass,ee as computeWrapperStyle,we as getCurrentComponent,$ as getDataAttributeName,fe as initMagnifier,ce as installTwicPics,c as isBrowser,r as isWebComponents,st as parseAlt,nt as parseAnchor,ot as parseAnchors,it as parseBot,rt as parseClassName,at as parseDuration,dt as parseEager,ft as parseFetchPriority,lt as parseFocus,mt as parseFocuses,pt as parseFrom,ht as parseIntrinsic,$t as parseMediaTag,gt as parseMode,bt as parseModes,vt as parsePlaceholder,yt as parsePosition,xt as parsePositions,kt as parsePreTransform,St as parseRatio,Ot as parseRatios,jt as parseRefit,Et as parseSizes,Mt as parseSrc,Nt as parseStep,zt as parseTitle,Pt as parseTo,At as parseTransition,Ct as parseTransitionDelay,Rt as parseTransitionDuration,Lt as parseTransitionTimingFunction,Ht as parseZoom,be as preComputePlaceholder,ge as preComputeVideoOptions,ve as styleToString};
//# sourceMappingURL=_utils.js.map
